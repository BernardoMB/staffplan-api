<main class="main-container">
    <div class="hero-content">
        <div class="row" id="staffTimeLineView">
            <div class="col-lg-12">
                <div class="row mb-2 justify-content-end">
                    <div class="col-3">
                        <button #anchor (click)="onToggle()" class="k-button  float-right">Customize Fields &nbsp;<i class="fa fa-th" aria-hidden="true"></i></button>
                        <kendo-popup [popupClass]="'content popup'" [anchor]="anchor" (anchorViewportLeave)="showColumnPopup = false" *ngIf="showColumnPopup">
                            <div class="text-center m-1">
                                <button class="k-button mr-1 btn-custom" (click)=filterApplayFunction();>Apply</button>
                                <button class="k-button mr-1" (click)=resetColumn(); >Clear</button>                   
                                <button class="k-button" (click)=closeColumnPopup();>
                                    <i class="fa fa-times column-menu-close"></i>
                                </button>
                            </div>
                            <div *ngFor="let column of columnForAddRemove; let i = index;" class="k-column-list">
                                <label class="k-column-list-item ng-star-inserted">
                                    <input
                                        class="k-checkbox checkbox-custom" type="checkbox" 
                                        id="{{column.columnId}}"
                                        [checked]="column.checked" 
                                        (change)="changeCheckbox(column.columnId,i)"
                                        >
                                    <span class="k-checkbox-label checkbox-custom-label"> {{column.columnLabel}}</span>
                                </label>
                            </div>
                        </kendo-popup>
                    </div>
                    <div class="col-3">
                        <div class="input-group search-input-group">
                            <div class="input-group-prepend">
                                <span class="input-group-text" id="basic-addon1"> <i class="fa fa-search"></i> </span>
                            </div>
                            <kendo-autocomplete [data]="typeAheadSuggestions" [filterable]="true" (valueChange)="getStaffListBySearch($event)" (filterChange)="getStaffDataByFilter($event)"[placeholder]="'Search name, role, city etc'"  [ngModel]="filterValue">
                        </kendo-autocomplete>
                    </div>
                </div>
            </div>
            <ng-template #content let-c="close" let-d="dismiss" style="width: 50%;max-width:  150%;">
                <div class="container-fluid">
                    <app-staff-view-project-details-popover (childStaffCloseEvent)="childStaffCloseEvent($event)"  [staffInstance]="selectedStaff" [renderTable]="renderTable">
                    </app-staff-view-project-details-popover>
                </div>
            </ng-template>


            <div class="row">
                <div class="col-lg-12" id="staffTimeLineTable">
                    <kendo-grid [data]="staffData"
                        [loading]="showLoader"
                        [sortable]="true"
                        [sort]="configs.sort"
                        [height]="gridHeight"
                        filterable="menu"
                        [filter]="configs.filter"
                        [resizable]="true"
                        [reorderable]="true"
                        [selectable]="true"
                        (selectionChange)="selectionChange($event)"
                        (dataStateChange)="dataStateChange($event)"
                        (detailExpand)="rowExpand($event)">
                        <kendo-grid-column field="{{column.columnId}}" title="{{column.columnLabel}}" width="150" *ngFor="let column of staffColumns"  [hidden]="hiddenColumn(column.columnId)">
                                        <ng-template kendoGridCellTemplate let-dataItem="dataItem" *ngIf="column.columnId == 'STAFF_NAME'">
                                <button type="button" class="btn btn-link btn-popover-link" container="body" placement="right-top"
                                        (click)="openVerticallyCentered(content,dataItem)" appHandlePopoverClose [ngClass]="{'selected-record':staffIdForClass === dataItem.STAFF_ID && projectIdForClass == dataItem.PROJECT_ID}">
                                        {{dataItem.STAFF_NAME}}
                            </button>
                        </ng-template>
                        <ng-template kendoGridCellTemplate let-dataItem="dataItem" *ngIf="column.columnId.indexOf('year_') == 0">
                            <kendo-sparkline [data]="dataItem[column.columnId]" type="column"
                                [seriesColors]="sparklineConfigs.colors"
                                [categoryAxis]="sparklineConfigs.categoryAxis"
                                [valueAxis]="sparklineConfigs.valueAxis"
                                class="w-100">
                                <kendo-chart-tooltip>
                                    <ng-template kendoChartSeriesTooltipTemplate let-value="value" let-category="category">
                                        <div [innerHTML]="getSparklineTooltip(dataItem, column.columnLabel, value, category)"></div>
                                    </ng-template>
                                </kendo-chart-tooltip>
                            </kendo-sparkline>
                        </ng-template>
                    </kendo-grid-column>
                    <div *kendoGridDetailTemplate="let dataItem">
                        <app-staff-view-project-details-grid [staffInstance]="dataItem" 
                            (childDeleteEvent)="childDeleteEvent($event)" (deleteCallback)="deleteCallbackFn">
                        </app-staff-view-project-details-grid>
                    </div>
                </kendo-grid>
                <kendo-dialog title="Please confirm" *ngIf="childDialogOpened"  (close)="childDeleteDialogAction(0)" [minWidth]="250" [width]="450">
                    <p style="margin: 30px; text-align: center;">{{childDeletePopupMessage}}</p>
                    <kendo-dialog-actions>
                        <button kendoButton (click)="childDeleteDialogAction(0)">No</button>
                        <button  kendoButton (click)="childDeleteDialogAction(1)" class="btn-custom">Yes</button>
                    </kendo-dialog-actions>
                </kendo-dialog>
            </div>
        </div>
        </div>
        </div>
    </div>
</main>